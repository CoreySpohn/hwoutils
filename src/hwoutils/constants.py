"""Physical constants and unit conversion factors.

Single source of truth for all constants used across the HWO simulation suite
(yippy, orbix, coronagraphoto, coronalyze, hwosim). All values are plain floats
or JAX arrays — no astropy.units dependency.
"""

import jax.numpy as jnp

# ---------------------------------------------------------------------------
# Mathematical constants
# ---------------------------------------------------------------------------
two_pi = 2 * jnp.pi
pi_over_2 = jnp.pi / 2
eps = jnp.finfo(jnp.float32).eps
GAUSSIAN_FWHM_FACTOR = 2 * jnp.sqrt(2 * jnp.log(2))  # sigma to FWHM

# ---------------------------------------------------------------------------
# Fundamental physical constants (SI)
# ---------------------------------------------------------------------------
h = 6.62607015e-34  # Planck constant [J·s]
c = 299792458.0  # Speed of light [m/s]
k_B = 1.380649e-23  # Boltzmann constant [J/K]
sigma_SB = 5.6703744191844314e-08  # Stefan-Boltzmann constant [W·m⁻²·K⁻⁴]

# ---------------------------------------------------------------------------
# Gravitational constant
# ---------------------------------------------------------------------------
G_si = 6.67430e-11  # [m³·kg⁻¹·s⁻²]
G = 1.488185170234519e-34  # [AU³·kg⁻¹·d⁻²] — for orbital dynamics

# ---------------------------------------------------------------------------
# Flux conversion
# ---------------------------------------------------------------------------
Jy = 1e-26  # 1 Jansky [W·m⁻²·Hz⁻¹]

# ---------------------------------------------------------------------------
# Length conversions
# ---------------------------------------------------------------------------
nm2m = 1e-9
m2nm = 1e9
um2m = 1e-6
m2um = 1e6
nm2um = 1e-3
um2nm = 1e3

# ---------------------------------------------------------------------------
# Distance conversions
# ---------------------------------------------------------------------------
AU2m = 1.495978707e11
m2AU = 6.684587122268445e-12
pc2m = 3.085677581491367e16
m2pc = 1.0 / pc2m
pc2AU = 2.062648062470964e05
Rearth2m = 6.3781e6  # Astropy/IAU default (equatorial)
Rearth2AU = Rearth2m * m2AU

# ---------------------------------------------------------------------------
# Mass conversions
# ---------------------------------------------------------------------------
Msun2kg = 1.988409870698051e30
Mearth2kg = 5.972167867791379e24
Mjup2kg = 1.8981245973360505e27

# ---------------------------------------------------------------------------
# Angular conversions
# ---------------------------------------------------------------------------
rad2arcsec = 206264.80624709636
arcsec2rad = 4.84813681109536e-06
mas2arcsec = 1e-3
arcsec2mas = 1e3
deg2rad = jnp.pi / 180.0
rad2deg = 180.0 / jnp.pi

# ---------------------------------------------------------------------------
# Time conversions
# ---------------------------------------------------------------------------
yr2s = 365.25 * 86400.0
s2yr = 1.0 / yr2s
d2s = 86400.0
s2d = 1.157407407407407e-05
J2000_JD = 2451545.0
